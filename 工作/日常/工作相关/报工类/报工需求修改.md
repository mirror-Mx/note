## 下料数可以输入一位小数

需求：

根据配置获取下料数是否能够输入小数

若是，只能输入数值，小数点后保留一位，超过不可输入

若否，只能输入数值，不能输入小数

思路：

配置为小数的情况下：

1. 输入的时候判断是否是数值且小数点后是否保留一位
   1. 若是，将当前数值存到缓存字段中
   2. 若否，则不能修改，将缓存字段对当前字段进行赋值替换（页面效果就是没法输入）

2. 报废数输入影响下料数的情况
   1. 下料数会根据可输入数值（下料和报废数总和最大值）修改，当输入报废数时，实时修改下料数（可输入数值 - 报废数），当报废数超过可输入数值时（即下料数<0）, 下料数只能为0

配置为整数的情况下：

1. 输入的时候判断是否是数值且是整数
   1. 若是，将当前数值存到缓存字段中
   2. 若否，则不能修改，将缓存字段对当前字段进行赋值替换（页面效果就是没法输入）

2. 报废数输入影响下料数的情况
   1. 下料数会根据可输入数值（下料和报废数总和最大值）修改，当输入报废数时，实时修改下料数（可输入数值 - 报废数），当报废数超过可输入数值时（即下料数<0）, 下料数只能为0

实现思路：

1. 获取初始缓存下料值，获取配置下料输入框是整数还是小数

2. 下料输入框输入，符合规则的就赋值给下料缓存数据，否则读取缓存，重新赋值给下料输入框，效果就是不改变原来数据
3. 报废数输入框输入，符合规则的就赋值给报废缓存数据，否则读取缓存，重新赋值，结束后，计算下料数（保留一位小数）

**GET：**

1. 判断是否是一位小数

   a. 正则表达式判断 -- 在我看来最优解

   ​	对于正则不够熟悉

   b. 直接判断 -- 通过是否为数值，是否包括小数点，小数点后位数

   总结：虽然最后能够实现，但是由于对正则表达式的不够熟悉，导致了虽然花了很多时间在正则上面，但是最终还是没有办法通过正则成功判断

2. 控制小数位数

   [JS - 控制小数位数的方法（保留小数点后N位、以及小数取整） (hangge.com)](https://www.hangge.com/blog/cache/detail_1791.html#)

   前提：在开发中经常会遇到需要对于小数取整或者保留几位小数的情况

   ```javascript
   var num = 5/3;
   console.log(num); // 1.6666666666666667
   ```

   a. 取整

   ```javascript
   // 直接取整（丢弃小数位数）
   let num = parseInt(5/3) // 1
   // 四舍五入取整
   let num = Math.round(5/3) // 2
   // 向上取整
   let num = Math.ceil(5/3) // 2
   // 向下取整
   let num = Math.floor(5/3) // 1
   ```

   b. 保留小数点后n位

   **使用toFixed()方法**

   > - **toFixed()** 方法可以将数字转换为字符串，并指定小数点后保留几位。如果小数实际位数不够指定的位数，不足的部分会补 **0**。所有主要浏览器都支持 **toFixed()** 方法。
   > - **toFixed()** 使用的是银行家舍入规则：四舍六入五取偶（又称四舍六入五留双）。
   > - **银行家舍入法：**
   >   四舍六入五考虑，五后非零就进一，五后为零看奇偶，五前为偶应舍去，五前为奇要进一。

   ```javascript
   var num1 = (5/3).toFixed(2);  // 1.67
   var num2 = (4).toFixed(2);  // 4.00
   var num3 = (0.015).toFixed(2);  // 0.01
   var num4 = (0.025).toFixed(2);  // 0.03
   ```

   **自定义转化方法**

   有的情况下，不需要补0；对于`toFixed`四舍六入武取偶的情况有的时候也难以理解，可以自定义一个转换方法

   ```javascript
   function toFixing(val, n) {
       return Math.round(val*Math.pow(10, n)) / Math.pow(10, n)
   }
   var num1 = toFixing(5/3, 2);  // 1.67
   var num2 = toFixing(4, 2);  // 4
   var num3 = toFixing(0.015, 2);  // 0.02
   var num4 = toFixing(0.025, 2);  // 0.03
   ```

   **自定义格式化输出**

   小数位四舍五入，自动补位，返回字符串

   ```javascript
   function toFixedFormat(val, n) {
       let f = Math.round(val*Math.pow(10, n)) / Math.pow(10, n)
       let s = f.toString()
       let rs = s.indexOf('.');
       if(rs < 0) {
          s += '.'
       }
       for(let i = s.length - s.indexOf('.'); i < n; i++ ) {
           s+='0'
       }
       return s
   }
   var num1 = toFixedFormat(5/3, 2);  // 1.67
   var num2 = toFixedFormat(4, 2);  // 4.00
   var num3 = toFixedFormat(0.015, 2);  // 0.02
   var num4 = toFixedFormat(0.025, 2);  // 0.03
   ```

3. 前端精度丢失问题

